{
  "submit_types": ["background", "serial", "parallel"],
  "default_submit_type": "serial",
  "background": {
    "SCHOST": "localhost",
    "ENV": {
       "MODULE_UDUNITS": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'udunits/2.2.28'); os.environ['LD_LIBRARY_PATH']=os.environ.get('UDUNITS_DIR') + '/lib/'",
       "MODULE_PROJ": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'proj/7.2.1')"
    },
    "tasks": [
      "Background", "Dummy"
    ]
  },
  "serial": {
    "SCHOST": "hpc",
    "ENV": {
      "MODULE_UDUNITS": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'udunits/2.2.28'); os.environ['LD_LIBRARY_PATH']='/usr/local/apps/udunits/2.2.28/lib/'",
      "MODULE_GDAL": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'gdal/3.2.1')",
      "MODULE_PROJ": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'proj/7.2.1')"
    },
    "HOST": "0",
    "BATCH": {
       "WALLTIME": "#SBATCH --time=00:05:00"
    }
  },
  "parallel": {
    "SCHOST": "hpc",
    "ENV": {
       "APURGE": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('purge')",
       "MODULE_UDUNITS": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'udunits/2.2.28'); os.environ['LD_LIBRARY_PATH']=os.environ.get('UDUNITS_DIR') + '/lib/'",
       "MODULE_PROJ": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'proj/7.2.1')",
       "OPENMPI0": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'prgenv/intel')",
       "OPENMPI1": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'intel/2021.4.0'); module('load','intel-mkl/19.0.5'); module('load', 'intel-mpi/2021.4.0')",
       "OMP_NUM_THREADS": "import os; os.environ['OMP_NUM_THREADS']='1';"
    },
    "BATCH": {
       "WALLTIME": "#SBATCH --time=00:10:00",
       "QOS": "#SBATCH --qos=nf",
       "NNODES": "#SBATCH  --nodes=1",
       "NTASKS": "#SBATCH  --ntasks=1",
       "NTPC": "#SBATCH --ntasks-per-core=1",
       "ACCOUNT": "#SBATCH --account=nores"
    },
    "tasks": [
      "Forecast", "PerturbedRun", "Pgd", "Prep", "Soda"
    ]
  },
  "task_exceptions": {
    "MakeOfflineBinaries": {
      "ENV": {
        "OPENMPI0": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'prgenv/gnu')",
        "OPENMPI1": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'openmpi')",
        "ECCODES": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'ecmwf-toolbox')",
        "NETCDF": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'netcdf4')",
        "WALLTIME": "#SBATCH --time=01:30:00"
      }
    },
    "CMakeBuild": {
      "ENV": {
         "APURGE": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('purge')",
         "OPENMPI0": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'prgenv/intel')",
         "OPENMPI1": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'intel/2021.4.0'); module('load','intel-mkl/19.0.5'); module('load', 'intel-mpi/2021.4.0')",
         "ECCODES": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'ecmwf-toolbox')",
         "NETCDF": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'netcdf4/4.7.4')",
         "WALLTIME": "#SBATCH --time=01:30:00"
      }
    },
      "Forecast": {
       "WRAPPER": "srun -n 32",
       "BATCH": {
           "WALLTIME": "#SBATCH --time=00:15:00",
           "NTASKS": "#SBATCH  --ntasks=32",
           "QOS": "#SBATCH --qos=np",
           "NNODES": "#SBATCH  --nodes=1",
           "NTPC": "#SBATCH --ntasks-per-core=1"
       },
       "ENV": {
          "OMP_NUM_THREADS": "import os; os.environ['OMP_NUM_THREADS']='1';"
       }
    },
    "QualityControl": {
      "ENV": {
        "ECCODES": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'ecmwf-toolbox')"
      }
    },
    "Forcing":{
       "ENV":{
           "EPYGRAM": "import sys; sys.path.insert(0, '/perm/hlam/apps/epygram/1.4.13/epygram'); sys.path.insert(0, '/perm/hlam/apps/epygram/1.4.13/site'); sys.path.insert(0, '/perm/hlam/apps/epygram/1.4.13')",
           "ECCODES": "exec(open('/usr/local/apps/lmod/8.6.8/init/env_modules_python.py').read()); module('load', 'ecmwf-toolbox')"
      }
    },
    "ModifyForcing":{
       "ENV":{
        "epygram": "import sys; sys.path.insert(0, '/perm/hlam/apps/epygram/1.4.13/epygram'); sys.path.insert(0, '/perm/hlam/apps/epygram/1.4.13/site'); sys.path.insert(0, '/perm/hlam/apps/epygram/1.4.13')"
      }
    }

  }
}
